#! /usr/bin/env bash

export bashum_cmd=${bashum_cmd:-bashum}
export bashum_home=${bashum_home:-$HOME/.bashum}

source $bashum_home/lib/require.sh

set -o errexit 
set -o errtrace 

require 'lib/tmp.sh' # for passivity
require 'lib/command.sh'
require 'lib/console.sh'
require 'lib/string.sh'

require 'commands/help.sh'

# if no args are provided, then go to the help menu
if (( $# == 0 ))
then
	help
	exit $?
fi

# see if the user was aiming for help
case "$1" in
	help|-h|--help)
		shift

		help "$@"
		exit $?
		;;
	#version|-v|--version)
		#shift

		#version "$@"
		#exit $?
		#;;
esac


# try to get the command
if ! cmd_tuple=( $(command_get_from_args "$@" ) ) 
then
	error "Unabe to locate command for args: $*"
	echo 

	help 
	exit 1
fi

# load the command
source ${cmd_tuple[0]}

# execute the command
$(command_get_main_fn ${cmd_tuple[0]}) "${cmd_tuple[@]:1}"
exit $?
